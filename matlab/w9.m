clear
close all

f = [0 7 12 15 15 12 7 0];
t = [0 1 2 3  5 6 7 8];


% plot(t, f, "-o");
% ylim([0 18]);
% hold on
% grid on

% ---------------- AR(2) --------------------


f = [0 0 0 1 1 1 2 2 2];
t = [0 1 2 3 4 5 6 7 8];

fz = f(3:9);
b1 = f(2:8);
b2 = f(1:7);

B = [b1; b2];

c = (fz*B')*(B*B')^(-1);
f10 = c(1)*2 + c(2)*2;

% ---------------- AR(3) --------------------


f = [0 0 0 1 1 1 2 2 2];
t = [0 1 2 3 4 5 6 7 8];

fz = f(4:9);
b1 = f(3:8);
b2 = f(2:7);
b3 = f(1:6);

B = [b1; b2; b3];

c = (fz*B')*(B*B')^(-1);
f10_2 = c(1)*2 + c(2)*2 + c(3)*2;

% ----------------- MA(2) ---------------
 
f  = [ 0 2 1 8 2 1 1 ];
t = [0 1 2 3 4 5 6 ];

fz = f(2:6);
b1 = f(3:7);
b2 = f(1:5);

B = [b1; b2];
c = (fz*B')*(B*B')^(-1);

fp = c*B;
% plot(t, f, "-", t(2:6), fp, "-")

% ------------------ AR(1) ---------------------------

f = [16 11 7 5 3 2];
t = [0 1 2 3 4 5];

tz = t(2:6);
fz = f(2:6);
b1 = f(1:5);

B =  b1 ;
c = (fz*B')*(B*B')^(-1);
fp = c*B;

e = sqrt(sum((fz-fp).^2));

% AR(2)
tz2 = t(3:6);
fz2 = f(3:6);
b1 = f(2:5);
b2 = f(1:4);

B = [ b1; b2 ];
c2 = (fz2*B')*(B*B')^(-1);
fp2 = c2*B;
plot(tz, fz, "-", tz, fp, "-*", tz2, fp2, "-*", 0,0);
hold on; grid on; legend;

e2 = sqrt(sum((fz2-fp2).^2));  % chyba ma o 1 clen menej!
