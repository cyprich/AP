close all
% t = linspace(1, 10, 10);
% f = [25 18 15 12 10 8 6 4 2 1];
% t = linspace(1, 4, 4);
% f = [25 18 15 12];

f = [135.5 135.78 135.88 135.76 135.95 136.14 137.72 137.56 138.26 137.95 137.0 136.62 138.75 137.64 138.22 139.85 138.76 139.07 139.58 138.42 134.61 137.43 137.82 136.0 135.47 136.04 137.0 138.6 140.41 136.83 139.79 143.24 144.12 141.77 140.66 142.38 143.5 142.59 142.58 138.82 140.58 139.08 140.45 137.66 137.14 135.94 135.63 134.94 136.44 135.97 136.96 134.45 134.15 131.67 133.36 132.5 132.9 131.63 130.39 131.05 132.18 132.82 132.99 132.18 133.2 129.22 130.29 130.49 129.9 129.08 128.53 128.21 127.72 126.87 127.09 126.05 127.74 127.3 126.5 128.49 126.72 127.65 127.39 126.64 128.74 129.12 129.99 130.47 127.09 125.27 126.16 127.43 125.95 127.15 128.08 128.14 127.54 127.65 129.2 135.47 134.27 133.2 131.28 131.61 131.21 132.88 132.48 136.93 137.9 138.0 136.17 135.32 137.02 135.68 135.58 135.63 137.73 137.77 138.4 139.5 141.01 140.22 141.21 139.91 ];
t = linspace(1, length(f), length(f));

grid on;
hold on;
plot(t, f, "-")

b0 = t.^0;
b1 = t.^1;
b2 = t.^2;
B = [b0; b1; b2];

A = [b0*b0' b1*b0' b2*b0'
    b0*b1' b1*b1' b2*b1'
    b0*b2' b1*b2' b2*b2'];
a = [f*b0'; f*b1'; f*b2';];

c = A\a;
fp = c'*B;

plot(t, fp, "-")

% tt = linspace(1, 10, 5000);
tt = linspace(1, 4, 5000);
BB = [tt.^0; tt.^1; tt.^2];
ffp = c'*BB;
plot(tt, ffp, "-")
